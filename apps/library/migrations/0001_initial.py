# Generated by Django 5.0.14 on 2025-12-20 07:52

import django.db.models.deletion
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('core', '0001_initial'),
        ('students', '0001_initial'),
        ('teachers', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='BookCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('name', models.CharField(help_text='Category name', max_length=100)),
                ('code', models.CharField(help_text='Category code', max_length=20)),
                ('description', models.TextField(blank=True, help_text='Description', null=True)),
                ('college', models.ForeignKey(help_text='College reference', on_delete=django.db.models.deletion.CASCADE, related_name='book_categories', to='core.college')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'book_category',
            },
        ),
        migrations.CreateModel(
            name='Book',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('title', models.CharField(help_text='Book title', max_length=300)),
                ('author', models.CharField(help_text='Author', max_length=200)),
                ('isbn', models.CharField(blank=True, help_text='ISBN', max_length=20, null=True)),
                ('publisher', models.CharField(blank=True, help_text='Publisher', max_length=200, null=True)),
                ('edition', models.CharField(blank=True, help_text='Edition', max_length=50, null=True)),
                ('publication_year', models.IntegerField(blank=True, help_text='Publication year', null=True)),
                ('language', models.CharField(blank=True, help_text='Language', max_length=50, null=True)),
                ('pages', models.IntegerField(blank=True, help_text='Number of pages', null=True)),
                ('quantity', models.IntegerField(help_text='Total quantity')),
                ('available_quantity', models.IntegerField(help_text='Available quantity')),
                ('price', models.DecimalField(blank=True, decimal_places=2, help_text='Price', max_digits=10, null=True)),
                ('location', models.CharField(blank=True, help_text='Shelf location', max_length=100, null=True)),
                ('barcode', models.CharField(blank=True, help_text='Barcode', max_length=50, null=True)),
                ('description', models.TextField(blank=True, help_text='Description', null=True)),
                ('cover_image', models.ImageField(blank=True, help_text='Cover image', null=True, upload_to='book_covers/')),
                ('college', models.ForeignKey(help_text='College reference', on_delete=django.db.models.deletion.CASCADE, related_name='books', to='core.college')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('category', models.ForeignKey(help_text='Category', on_delete=django.db.models.deletion.CASCADE, related_name='books', to='library.bookcategory')),
            ],
            options={
                'db_table': 'book',
            },
        ),
        migrations.CreateModel(
            name='BookIssue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('issue_date', models.DateField(help_text='Issue date')),
                ('due_date', models.DateField(help_text='Due date')),
                ('return_date', models.DateField(blank=True, help_text='Return date', null=True)),
                ('status', models.CharField(choices=[('issued', 'Issued'), ('returned', 'Returned'), ('overdue', 'Overdue')], default='issued', help_text='Status', max_length=20)),
                ('remarks', models.TextField(blank=True, help_text='Remarks', null=True)),
                ('book', models.ForeignKey(help_text='Book', on_delete=django.db.models.deletion.CASCADE, related_name='issues', to='library.book')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('issued_by', models.ForeignKey(blank=True, help_text='Issued by', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='library_issues', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'book_issue',
            },
        ),
        migrations.CreateModel(
            name='BookReturn',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('return_date', models.DateField(help_text='Return date')),
                ('fine_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Fine amount', max_digits=8)),
                ('is_damaged', models.BooleanField(default=False, help_text='Damaged flag')),
                ('damage_charges', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Damage charges', max_digits=8)),
                ('remarks', models.TextField(blank=True, help_text='Remarks', null=True)),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('issue', models.ForeignKey(help_text='Issue', on_delete=django.db.models.deletion.CASCADE, related_name='returns', to='library.bookissue')),
                ('received_by', models.ForeignKey(blank=True, help_text='Received by', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='library_returns_received', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'book_return',
            },
        ),
        migrations.CreateModel(
            name='LibraryMember',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('member_type', models.CharField(choices=[('student', 'Student'), ('teacher', 'Teacher')], help_text='Type (student/teacher)', max_length=20)),
                ('member_id', models.CharField(help_text='Member ID', max_length=50, unique=True)),
                ('joining_date', models.DateField(help_text='Joining date')),
                ('max_books_allowed', models.IntegerField(default=3, help_text='Max books')),
                ('college', models.ForeignKey(help_text='College reference', on_delete=django.db.models.deletion.CASCADE, related_name='library_members', to='core.college')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('student', models.ForeignKey(blank=True, help_text='Student', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='library_memberships', to='students.student')),
                ('teacher', models.ForeignKey(blank=True, help_text='Teacher', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='library_memberships', to='teachers.teacher')),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'library_member',
            },
        ),
        migrations.CreateModel(
            name='LibraryFine',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('amount', models.DecimalField(decimal_places=2, help_text='Amount', max_digits=8)),
                ('reason', models.TextField(help_text='Reason')),
                ('fine_date', models.DateField(help_text='Fine date')),
                ('is_paid', models.BooleanField(default=False, help_text='Paid status')),
                ('paid_date', models.DateField(blank=True, help_text='Paid date', null=True)),
                ('remarks', models.TextField(blank=True, help_text='Remarks', null=True)),
                ('book_issue', models.ForeignKey(blank=True, help_text='Book issue', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='library_fines', to='library.bookissue')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('member', models.ForeignKey(help_text='Member', on_delete=django.db.models.deletion.CASCADE, related_name='library_fines', to='library.librarymember')),
            ],
            options={
                'db_table': 'library_fine',
            },
        ),
        migrations.CreateModel(
            name='LibraryCard',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('card_number', models.CharField(help_text='Card number', max_length=50, unique=True)),
                ('issue_date', models.DateField(help_text='Issue date')),
                ('valid_until', models.DateField(help_text='Valid until')),
                ('card_file', models.FileField(blank=True, help_text='Card PDF', null=True, upload_to='library_cards/')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('member', models.ForeignKey(help_text='Member', on_delete=django.db.models.deletion.CASCADE, related_name='cards', to='library.librarymember')),
            ],
            options={
                'db_table': 'library_card',
            },
        ),
        migrations.CreateModel(
            name='BookReservation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the record was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was last updated')),
                ('is_active', models.BooleanField(db_index=True, default=True, help_text='Indicates if the record is active (soft delete)')),
                ('reservation_date', models.DateField(help_text='Reservation date')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('approved', 'Approved'), ('cancelled', 'Cancelled'), ('fulfilled', 'Fulfilled')], default='pending', help_text='Status', max_length=20)),
                ('remarks', models.TextField(blank=True, help_text='Remarks', null=True)),
                ('book', models.ForeignKey(help_text='Book', on_delete=django.db.models.deletion.CASCADE, related_name='reservations', to='library.book')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('member', models.ForeignKey(help_text='Member', on_delete=django.db.models.deletion.CASCADE, related_name='reservations', to='library.librarymember')),
            ],
            options={
                'db_table': 'book_reservation',
            },
        ),
        migrations.AddField(
            model_name='bookissue',
            name='member',
            field=models.ForeignKey(help_text='Member', on_delete=django.db.models.deletion.CASCADE, related_name='issues', to='library.librarymember'),
        ),
        migrations.AddIndex(
            model_name='bookcategory',
            index=models.Index(fields=['college', 'code'], name='book_catego_college_274387_idx'),
        ),
        migrations.AddIndex(
            model_name='bookcategory',
            index=models.Index(fields=['college', 'is_active'], name='book_catego_college_3c1393_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='bookcategory',
            unique_together={('college', 'code')},
        ),
        migrations.AddIndex(
            model_name='book',
            index=models.Index(fields=['college', 'category'], name='book_college_a54de9_idx'),
        ),
        migrations.AddIndex(
            model_name='book',
            index=models.Index(fields=['isbn'], name='book_isbn_e93b35_idx'),
        ),
        migrations.AddIndex(
            model_name='book',
            index=models.Index(fields=['barcode'], name='book_barcode_9ac48b_idx'),
        ),
        migrations.AddIndex(
            model_name='book',
            index=models.Index(fields=['title'], name='book_title_e39da6_idx'),
        ),
        migrations.AddIndex(
            model_name='book',
            index=models.Index(fields=['college', 'is_active'], name='book_college_94bb8c_idx'),
        ),
        migrations.AddIndex(
            model_name='bookreturn',
            index=models.Index(fields=['issue', 'return_date'], name='book_return_issue_i_23545c_idx'),
        ),
        migrations.AddIndex(
            model_name='librarymember',
            index=models.Index(fields=['college', 'member_id'], name='library_mem_college_09e6c0_idx'),
        ),
        migrations.AddIndex(
            model_name='librarymember',
            index=models.Index(fields=['student'], name='library_mem_student_1efb99_idx'),
        ),
        migrations.AddIndex(
            model_name='librarymember',
            index=models.Index(fields=['teacher'], name='library_mem_teacher_eae1b8_idx'),
        ),
        migrations.AddConstraint(
            model_name='librarymember',
            constraint=models.UniqueConstraint(condition=models.Q(('student__isnull', False)), fields=('college', 'student'), name='unique_library_member_student'),
        ),
        migrations.AddConstraint(
            model_name='librarymember',
            constraint=models.UniqueConstraint(condition=models.Q(('teacher__isnull', False)), fields=('college', 'teacher'), name='unique_library_member_teacher'),
        ),
        migrations.AddIndex(
            model_name='libraryfine',
            index=models.Index(fields=['member', 'fine_date', 'is_paid'], name='library_fin_member__930933_idx'),
        ),
        migrations.AddIndex(
            model_name='librarycard',
            index=models.Index(fields=['member', 'card_number'], name='library_car_member__d1cdda_idx'),
        ),
        migrations.AddIndex(
            model_name='bookreservation',
            index=models.Index(fields=['book', 'member', 'reservation_date', 'status'], name='book_reserv_book_id_0fed08_idx'),
        ),
        migrations.AddIndex(
            model_name='bookissue',
            index=models.Index(fields=['book', 'member'], name='book_issue_book_id_43167a_idx'),
        ),
        migrations.AddIndex(
            model_name='bookissue',
            index=models.Index(fields=['issue_date'], name='book_issue_issue_d_590cef_idx'),
        ),
        migrations.AddIndex(
            model_name='bookissue',
            index=models.Index(fields=['due_date'], name='book_issue_due_dat_68c10f_idx'),
        ),
        migrations.AddIndex(
            model_name='bookissue',
            index=models.Index(fields=['status'], name='book_issue_status_6591cb_idx'),
        ),
    ]
